# 快速入门

- 视频教程 [JumpServer 从入门到精通](https://www.bilibili.com/video/BV19D4y1S7s4){:target="_blank"}

!!! info "以下操作均在 Web 页面完成，请使用 admin 用户登陆，默认密码 admin"

## 一、系统设置

### 1.1 基本设置

| 名称          | 示例                        | 备注                                         |
| ------------ | --------------------------- | -------------------------------------------- |
| 当前站点URL   | https://demo.jumpserver.org | 不设置的话，邮件收到的地址为 `http://localhost` |
| 用户向导URL   |                             | 用户首次登陆可以看到此 `超链接`，可以不设置      |
| 忘记密码URL   |                             | 使用了 LDAP, OPENID 等外部认证系统，可以自定义  |

### 1.2 邮件设置

!!! warning "必须设置才能使用与邮件相关的功能"
!!! danger "不可以同时勾选 `使用SSL` 和 `使用TLS`"

| 名称 | 示例 | 备注 |
| ---------- | ---------------- | ---------------------------------- |
| SMTP主机   | smtp.qq.com      | 服务商提供的 smtp 服务器             |
| SMTP端口   | 25               | 通常是 `25`                         |
| SMTP账号   | 296015668@qq.com | 通常是 `user@domain.com`            |
| SMTP密码   | **************** | 每次 `测试连接` 都需要重新输入密码    |
| 使用SSL    | [ ]              | 如果端口使用 `465`，必须勾选此项      |
| 使用TLS    | [ ]              | 如果端口使用 `587`，必须勾选此项      |
| 发件人     | 296015668@qq.com | `测试连接` 必须要输入                |
| 主题前缀   | [JMS]            | 邮件的标题，收到的邮件是 `[JMS]` 开头 |
| 测试收件人 | 296015668@qq.com | 测试连接必填                         |


## 二、资产管理

!!! note "准备两个测试资产和一个数据库来验证功能"

|      IP      |    Host name    |    Port    |   System   |  Admin User   |    Password   |
| ------------ | --------------- | ---------- | ---------- |--- ---------- |--- ---------- |
| 172.16.80.11 |    test_ssh01   |     22     |  Centos 7  |      root     |  Test2020.L   |
| 172.16.80.21 |    test_rdp01   |    3389    | Windows 10 | administrator |  Test2020.W   |
| 172.16.80.31 |   test_mysql01  |    3306    |   MySQL 5  |      root     |  Test2020.M   |

!!! warning "Windows 资产先进行 [Windows SSH 设置](assets/windows_ssh.md)"

!!! warning "MySQL 应用需要授权 Core 和 KoKo 的远程访问的权限 [MySQL 应用要求](app/mysql.md)"

### 2.1 编辑资产树###

!!! warning "根节点 Default 不能重名，右击节点可以添加、删除和重命名节点，以及进行资产相关的操作"

!!! note "说明"
    点击页面左侧的 `资产管理` - `资产列表`  
    先在根节点 `Default` 右键新建 `SSH Server` 和 `RDP Server` 两个节点

```
Defaule
├─ SSH Server
└─ RDP Server
```

### 2.2 创建特权用户

!!! note "点击页面左侧的 `资产管理` - `系统用户` - `创建特权用户` 创建两个特权用户，特权用户的内容就是上面表单的 `Admin User` 和 `Password`"
!!! warning "名称不能重名，密码或者密钥二选一即可，一些资产不允许通过 密码 认证可以改用 私钥 认证"

| 表单    | root 特权用户示例  | administrator 特权用户示例  |
| ------- | ----------------- | -------------------------- |
| 名称    | 172.16.80.11_root | 172.16.80.21_administrator |
| 用户名  | root              | administrator              |
| 密码    | Test2020.L        | Test2020.W                 |
| SSH密钥 |                   |                            |
| 备注    | SSH 资产特权用户   | RDP 资产特权用户            |

### 2.3 创建资产

!!! note "点击页面左侧的 `资产管理` - `资产列表` - `创建资产` 把两个资产导入"
!!! warning "主机名不能重名"

| 表单     | SSH 资产示例         | RDP 资产示例                |  
| -------- | ------------------- | -------------------------- |
| 主机名   | test_ssh01           | test_rdp01                 |
| IP(域名) | 172.16.80.11         | 172.16.80.21               |
| 系统平台 | Linux                | Windows                    |
| 公网IP   |                      |                            |
| 网域     |                      |                            |
| 协议组   | ssh 22               | rdp 3389 / ssh 22          |
| 特权用户 | 172.16.80.11_root    | 172.16.80.21_administrator |
| 节点     | Default / SSH Server | Default / RDP Server       |

!!! warning "创建 Windows 资产，注意协议组我们需要选择 `ssh` 和 `rdp`，否则无法获取 Windows 资产的状态及硬件信息"

??? tip "测试资产连接提示"
    1. 资产创建信息填写好保存之后隔几秒钟时间刷新一下网页，`ssh` 协议资产的可连接图标会显示 `绿色`，且 `硬件信息` 会显示出来  
    2. 如果 `可连接` 的图标是 `黄色` 或者 `红色`，可以点击 `资产` 的 `名称`，在右侧 `快速修改` - `测试可连接性` 点击 `测试` 按钮，根据错误提示处理  
    3. 被连接 `Linux` 资产需要 `python` 组件，且版本大于等于 `2.6`，`Ubuntu` 等资产默认不允许 `root` 用户远程 `ssh` 登录，请自行处理，`Windows` 资产需要手动安装 `OpenSSH Server `
    4. 如果资产不能正常连接，请检查 特权用户 的 `用户名` 和 `密码` 是否正确以及该 `特权用户` 是否能使用 `SSH` 从 `JumpServer` 主机正确登录到资产主机上

### 2.3.1 创建数据库应用

!!! note "击页面左侧的 `应用管理` - `数据库应用` - `创建数据库应用` 创建 mysql 数据库"

| 表单   | MySQL 资产示例 |
| ------ | ------------- |
| 名称   | test_mysql01  |
| 类型   | MySQL         |
| 主机   | 172.16.80.31  |
| 端口   | 3306          |
| 数据库 |               |
| 备注   | MySQL 资产    |

!!! tip "名称、主机、数据库选项为必填项"

### 2.4 创建系统用户

|      IP      |   System   |  System User  |    Password   |     Group    |     Sudo     |  Sftp Root  |
| ------------ | ---------- | ------------- | ------------- | ------------ | ------------ | ----------- |
| 172.16.80.11 |  Centos 7  |   testssh01   |  random pass  |              |      ALL     |      /      |
| 172.16.80.21 | Windows 10 |   testrdp01   |  random pass  |     Users    |              |             |
| 172.16.80.23 |   MySQL 5  |      root     |  Test2020.M   |              |              |             |

??? tip "系统用户提示"
    在理解 `系统用户` 之前，你首先得知道系统用户是干嘛用的. 在 `Jumpserver` 中，需要对资产不同的用途创建不同的 `系统用户`  
    比如一个 `资产`，开发要用、测试要用、可能还要其他的部门也要使用，偷懒的人可能会统一给 `root` 用户，但是这样并不安全  
    系统用户就是为了解决这个问题，我们针对不同的用途创建不同的 `系统用户`，`Linux` 通过 `Sudo` 来控制用户的权限，`Windows` 通过组来控制用户权限

!!! note "点击页面左侧的 `资产管理` - `系统用户` - `创建普通用户` 创建对应协议系统用户"
=== "SSH 系统用户（关闭自动推送）"
    !!! tip ""
	!!! tip "关闭自动生成，需手动输入该系统用户密码"
| 表单        | SSH 系统用户           |
| ----------- | ---------------------- |
| 名称        | test_ssh01_测试系统用户 |
| 协议        | ssh                    |
| 用户名      | testssh01              |
| 动态用户名  |                        |
| 登录模式    | 自动登陆                |
| 认证方式    | 托管密码               |
| 自动生成    | ×                     | 
| 自动推送    | ×                      |
| Sudo        | ALL                    |
| Shell       | /bin/bash              |
| 家目录      |                        |
| 用户附属组  |                         |
| 命令过滤器  |                         |
| SFTP根路径  | /                      |

| 表单        | RDP 系统用户          |
| ----------- | --------------------- |
| 名称        | test_rdp01_测试系统用户 |
| 协议        | rdp                    |
| 用户名      | testssh01              |
| 动态用户名  |                        |
| 认证方式    | 托管密码               |
| 自动生成    | ×                     |
| 自动推送    | ×                      |
| AD域名      |                       |
| 自动推送    | ×                      |
| 用户附属组  | Users                  |

| 表单     | MySQL 系统用户            |
| -------- | ------------------------ |
| 名称     | test_mysql01_测试系统用户 |
| 认证方式 | 托管密码                  |
| 用户名   | root                     |
| 协议     | mysql                    |
| 密码     | Test2020.M               |

=== "SSH 系统用户（自动推送）"
    !!! tip ""
| 表单        | SSH 系统用户           |
| ----------- | ---------------------- |
| 名称        | test_ssh02_测试系统用户 |
| 协议        | ssh                    |
| 用户名      | testssh02              |
| 动态用户名  |                        |
| 登录模式    | 自动登陆                |
| 认证方式    | 托管密码               |
| 自动生成    | √                     | 
| 自动推送    | √                      |
| Sudo        | ALL                    |
| Shell       | /bin/bash              |
| 家目录      |                        |
| 用户附属组  |                         |
| 命令过滤器  |                         |
| SFTP根路径  | /                      |

| 表单        | RDP 系统用户          |
| ----------- | --------------------- |
| 名称        | test_rdp01_测试系统用户 |
| 协议        | rdp                    |
| 用户名      | testssh01              |
| 动态用户名  |                        |
| 认证方式    | 托管密码               |
| 自动生成    | √                     |
| 自动推送    | √                      |
| AD域名      |                       |
| 自动推送    | √                      |
| 用户附属组  | Users                  |

| 表单     | MySQL 系统用户            |
| -------- | ------------------------ |
| 名称     | test_mysql01_测试系统用户 |
| 认证方式 | 托管密码                  |
| 用户名   | root                     |
| 协议     | mysql                    |
| 密码     | Test2020.M               |

## 三、创建授权规则

### 3.1 为用户分配资产

|      IP      |   System   |  System User  |       User      |
| ------------ | ---------- | ------------- | --------------- |
| 172.16.80.11 |  Centos 7  |   testssh01   |      admin      |
| 172.16.80.21 | Windows 10 |   testrdp01   |      admin      |
| 172.16.80.31 |  MySQL 5   |      root     |      admin      |

!!! note "点击页面左侧的 `授权管理` - `资产授权` - `创建授权规则` 创建两个授权"

| 表单     | SSH 资产授权                       | RDP 资产授权                      |
| -------- | --------------------------------- | -------------------------------- |
| 名称     | test_ssh01_测试授权                | test_rdp01_测试授权               |
| 用户     | Administrator(admin)              | Administrator(admin)              |
| 用户组   |                                   |                                   |
| 资产     | test_ssh01(172.16.80.11)          |          test_rdp01(172.16.80.21) |
| 节点     |                                   |                                   |
| 系统用户 | test_ssh01_测试系统用户(testssh01) | test_rdp01_测试系统用户(testrdp01) |
| 权限     | √ 全部                            | √ 全部                            |

??? tip "资产授权提示"
    `名称`，授权的名称，不能重复  
    `用户` 和 `用户组` 二选一，不推荐即选择 `用户` 又选择 `用户组`  
    `资产` 和 `节点` 二选一，选择 `节点` 会包含 `节点` 下面的所有 `资产`  
    `系统用户`，及所选的 `用户` 或 `用户组` 下的 `用户` 能通过该 `系统用户` 使用所选 `节点` 或者 `节点` 下的 `资产`  
    `用户(组)`，`资产(节点)`，`系统用户` 是一对一的关系，所以当拥有 `Linux`、`Windows` 不同类型资产时，应该分别给 `Linux` 资产和 `Windows` 资产创建 `授权规则`  
    一般情况下，`资产` 授权给 `用户`，`节点` 授权给 `用户组`，一个 `授权` 只能选择一个 `系统用户`

### 3.1.1 为用户分配数据库应用

!!! note "点击页面左侧的 `授权管理` - `数据库应用` - `创建授权规则`  创建数据库授权"

| 表单       | MySQL 资产授权                 |
| ---------- | ----------------------------- |
| 名称       | test_mysql01_测试授权          |
| 用户       | Administrator(admin)          |
| 用户组     |                               |
| 数据库应用 | test_mysql01                   |
| 系统用户   | test_mysql01_测试系统用户(root) |

## 四、用户登录

!!! tip "登录 JumpServer"
    点击页面左侧的 `会话管理` - `Web终端`
    用户只能看到自己被管理员授权了的 `资产`，如果登录后无资产，请联系管理员进行确认

!!! tip "连接资产"
    在我的资产点击资产右边的  `连接`  快速连接资产  
    也可以点击左侧栏的  `Web终端`
    点击  `资产`  名字，就连上资产了  
    如果显示连接 `超时`，请参考 `FAQ` 文档进行处理

!!! tip "断开资产"
    点击页面顶部的 `Server` 按钮会弹出选个选项，第一个断开所选的连接，第二个断开所有连接  
    也可以直接点资产小窗口的 X，`SSH` 会话也可以输入 `exit` 来退出  
    直接关闭页面也可以，但是不推荐

!!! tip "文件管理"
    点击 `文件管理`  
    先在左边选择 `资产`，目前只支持自动登录的 `SSH` 协议 `资产`  
    也可以使用 `sftp` 方式进行 `文件管理`

!!! note "以上就是 JumpServer 的简易入门了，JumpServer 还有很多功能等待您去发现"
